<?xml version='1.0' encoding='utf-8' standalone='yes'?>
<?xml-stylesheet href="./_c74_ref.xsl" type="text/xsl"?>
<!--
Part of the Fluid Corpus Manipulation Project (http://www.flucoma.org/)
Copyright 2017-2019 University of Huddersfield.
Licensed under the BSD-3 License.
See license.md file in the project root for full license information.
This project has received funding from the European Research Council (ERC)
under the European Unionâ€™s Horizon 2020 research and innovation programme
(grant agreement No 725899).
-->
<!-- DO NOT EDIT THIS FILE ... YOU WILL LOSE YOUR WORK -->
<c74object name='fluid.bufonsetslice~' category='FluidCorpusManuipulation'>
	<digest>Spectral Difference-Based Audio Buffer Slicer</digest>
	<description><div class="document">
<p>Implements many spectral-based onset detection metrics, most of them taken from the literature.</p>
</div>
</description>
  <discussion>
      <h4><openfilelink filename="Fluid Corpus Manipulation Toolkit.maxpat">Open the Overview Patch</openfilelink></h4>
    <div class="document">
<p>For an overview of onset detection metrics see (<a class="reference external" href="http://www.dafx.ca/proceedings/papers/p_133.pdf">http://www.dafx.ca/proceedings/papers/p_133.pdf</a>). Some are already available in SuperCollider's Onsets object, yet not as offline processes.</p>
<p>The process will return a buffer which contains indices (in sample) of estimated starting points of different slices.</p>
</div>


		fluid.bufonsetslice~ is part of the Fluid Decomposition Toolkit of the FluCoMa project. For more explanations, learning material, and discussions on its musicianly uses, visit <a href="http://www.flucoma.org/">flucoma.org</a>.

  </discussion>
	<!--METADATA-->
	<metadatalist>
		<metadata name='author'>FluCoMa</metadata>
		<metadata name='tag'>Fluid Decomposition</metadata>
		<metadata name='tag'>corpus</metadata>
	</metadatalist>
	<!--ARGUMENTS-->
	<objarglist><objarg name='maxfftsize' optional='1' type='number'>
        <digest>
          Maxiumm FFT Size
        </digest>
        <description>
          <div class="document">
<p>How large can the FFT be, by allocating memory at instantiation time. This cannot be modulated.</p>
</div>

          <h5>Constraints</h5><ul><li>Minimum: 4</li><li>Snaps to powers of two</li></ul>
        </description><attributelist>
          <attribute name="default" get="1" set="1" type="int" size='1' value='16384' />
        </attributelist></objarg><!-- <objarg name='function' optional='1' type='number'>
			<digest>Initial easing function to use</digest>
			<description>Initial easing function to use. </description>
		</objarg>-->
	</objarglist>
	<!--MESSAGES-->
  <methodlist><method name="bang">
     <arglist />
     <digest>
       Trigger processing
     </digest>
     <description>
       A bang will commence processing on object given its current settings, unless it is already busy. In that case, the behaviour depends on the value of the <m>queue</m> attribute.
     </description>
   </method>
   <method name="cancel">
     <arglist />
     <digest>
       Cancel non-blocking processing
     </digest>
     <description>
       When processing in non-blocking mode, this will cancel the job underway, without updating destination buffers.
     </description>
   </method><method name="reset">
      <arglist />
      <digest>
        Return the object to its original state
      </digest>
      <description>
        Calling <m>reset</m> will change parameter values back to those the object was <i>created</i> with, i.e. any attribute values set in the box will be retained
      </description>
    </method></methodlist>
	<!--ATTRIBUTES-->
	<attributelist><attribute name='blocking' get='1' set='1' type='int' size='1'>
        <digest>
          Blocking Mode
        </digest>
        <description>
          <div class="document">
<p>Set the threading mode for the object</p>
</div>

          
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='1' /><attribute name="enumvals" get="1" set="1" type="atom" size='3'>
            <enumlist><enum name='Non-Blocking'>
                <description>
                  <div class="document">
<p>Processing runs in a worker thread</p>
</div>

                </description>
              </enum><enum name='Blocking (Low Priority)'>
                <description>
                  <div class="document">
<p>Processing runs in the main application thread</p>
</div>

                </description>
              </enum><enum name='Blocking (High Priority)'>
                <description>
                  <div class="document">
<p>(Max only) Processing runs in the scheduler thread</p>
</div>

                </description>
              </enum></enumlist>
          </attribute></attributelist></attribute><attribute name='fftsettings' get='1' set='1' type='int' size='3'>
        <digest>
          FFT Settings
        </digest>
        <description>
          <div class="document">
<p>FFT settings consist of three numbers representing the window size, hop size and FFT size in samples:</p>
<p>The hop size and fft size can both be set to -1 (and are by default), with slightly different meanings:</p>
<ul class="simple">
<li>For the hop size, -1 = <tt class="docutils literal">windowSize/2</tt></li>
<li>For the FFT size, -1 = <tt class="docutils literal">windowSize</tt> snapped to the nearest equal / greater power of 2 (e.g. <tt class="docutils literal">windowSize 1024</tt> =&gt; <tt class="docutils literal">fftSize 1024</tt>, but <tt class="docutils literal">windowsSize 1000</tt> also =&gt; <tt class="docutils literal">fftSize 1024</tt>)</li>
</ul>
</div>

          <h5>Constraints</h5><ul><li> FFTSize, if != -1, will set to the next greatest power of two &gt; 4</li><li>The maximum manual FFT size is limited to the value of the <at>maxfftsize</at> initialization argument</li><li>if FFT size != -1, then window size is clipped at FFT size</li></ul>
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='3' value='[[&#39;winSize&#39;, 1024], [&#39;hopSize&#39;, -1], [&#39;fftSize&#39;, -1]]' /></attributelist></attribute><attribute name='filtersize' get='1' set='1' type='int' size='1'>
        <digest>
          Filter Size
        </digest>
        <description>
          <div class="document">
<p>The size of a smoothing filter that is applied on the novelty curve. A larger filter filter size allows for cleaner cuts on very sharp changes.</p>
</div>

          <h5>Constraints</h5><ul><li>Minimum: 1</li><li>Maximum: 101</li><li>Snaps to odd numbers</li></ul>
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='5' /></attributelist></attribute><attribute name='framedelta' get='1' set='1' type='int' size='1'>
        <digest>
          Frame Delta
        </digest>
        <description>
          <div class="document">
<p>For certain metrics (HFC, SpectralFlux, MKL, Cosine), the distance does not have to be computed between consecutive frames. By default (0) it is, otherwise this sets the distane between the comparison window in samples.</p>
</div>

          <h5>Constraints</h5><ul><li>Minimum: 0</li></ul>
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='0' /></attributelist></attribute><attribute name='indices' get='1' set='1' type='symbol' size='1'>
        <digest>
          Indices Buffer
        </digest>
        <description>
          <div class="document">
<p>The index of the buffer where the indices (in sample) of the estimated starting points of slices will be written. The first and last points are always the boundary points of the analysis.</p>
</div>

          
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='None' /></attributelist></attribute><attribute name='metric' get='1' set='1' type='int' size='1'>
        <digest>
          Spectral Change Metric
        </digest>
        <description>
          <div class="document">
<p>The metric used to derive a difference curve between spectral frames. It can be any of the following:</p>
</div>

          
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='0' /><attribute name="enumvals" get="1" set="1" type="atom" size='10'>
            <enumlist><enum name='Energy'>
                <description>
                  <div class="document">
<p><strong>Energy</strong> thresholds on (sum of squares of magnitudes / nBins) (like Onsets power)</p>
</div>

                </description>
              </enum><enum name='High Frequency Content'>
                <description>
                  <div class="document">
<p><strong>HFC</strong> thresholds on (sum of (squared magnitudes * binNum) / nBins)</p>
</div>

                </description>
              </enum><enum name='Spectral Flux'>
                <description>
                  <div class="document">
<p><strong>SpectralFlux</strong> thresholds on (diffence in magnitude between consecutive frames, half rectified)</p>
</div>

                </description>
              </enum><enum name='Modified Kullback-Leibler'>
                <description>
                  <div class="document">
<p><strong>MKL</strong> thresholds on (sum of log of magnitude ratio per bin) (or equivalently, sum of difference of the log magnitude per bin) (like Onsets mkl)</p>
</div>

                </description>
              </enum><enum name='Itakura-Saito'>
                <description>
                  <div class="document">
<p><strong>IS</strong> (WILL PROBABLY BE REMOVED) Itakura - Saito divergence (see literature)</p>
</div>

                </description>
              </enum><enum name='Cosine'>
                <description>
                  <div class="document">
<p><strong>Cosine</strong> thresholds on (cosine distance between comparison frames)</p>
</div>

                </description>
              </enum><enum name='Phase Deviation'>
                <description>
                  <div class="document">
<p><strong>PhaseDev</strong> takes the past 2 frames, projects to the current, as anticipated if it was a steady state, then compute the sum of the differences, on which it thresholds (like Onsets phase)</p>
</div>

                </description>
              </enum><enum name='Weighted Phase Deviation'>
                <description>
                  <div class="document">
<p><strong>WPhaseDev</strong> same as PhaseDev, but weighted by the magnitude in order to remove chaos noise floor (like Onsets wphase)</p>
</div>

                </description>
              </enum><enum name='Complex Domain'>
                <description>
                  <div class="document">
<p><strong>ComplexDev</strong> same as PhaseDev, but in the complex domain - the anticipated amp is considered steady, and the phase is projected, then a complex subtraction  is done with the actual present frame. The sum of magnitudes is used to threshold (like Onsets complex)</p>
</div>

                </description>
              </enum><enum name='Rectified Complex Domain'>
                <description>
                  <div class="document">
<p><strong>RComplexDev</strong> same as above, but rectified (like Onsets rcomplex)</p>
</div>

                </description>
              </enum></enumlist>
          </attribute></attributelist></attribute><attribute name='minslicelength' get='1' set='1' type='int' size='1'>
        <digest>
          Minimum Length of Slice
        </digest>
        <description>
          <div class="document">
<p>The minimum duration of a slice in number of hopSize.</p>
</div>

          <h5>Constraints</h5><ul><li>Minimum: 0</li></ul>
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='2' /></attributelist></attribute><attribute name='numchans' get='1' set='1' type='int' size='1'>
        <digest>
          Number of Channels
        </digest>
        <description>
          <div class="document">
<p>For multichannel sources, how many channel should be summed.</p>
</div>

          
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='-1' /></attributelist></attribute><attribute name='numframes' get='1' set='1' type='int' size='1'>
        <digest>
          Number of Frames
        </digest>
        <description>
          <div class="document">
<p>How many frames should be processed.</p>
</div>

          
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='-1' /></attributelist></attribute><attribute name='queue' get='1' set='1' type='int' size='1'>
        <digest>
          Non-Blocking Queue Flag
        </digest>
        <description>
          <div class="document">
<p>In non-blocking mode enable jobs to be queued up if successive bangs are sent whilst the object is busy. With the queue disabled, successive bangs will produce a warning. When enabled, the object will processing successively, against the state of its parameters when each bang was sent</p>
</div>

          
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='0' /></attributelist></attribute><attribute name='source' get='1' set='1' type='symbol' size='1'>
        <digest>
          Source Buffer
        </digest>
        <description>
          <div class="document">
<p>The index of the buffer to use as the source material to be sliced through novelty identification. The different channels of multichannel buffers will be summed.</p>
</div>

          
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='None' /></attributelist></attribute><attribute name='startchan' get='1' set='1' type='int' size='1'>
        <digest>
          Start Channel
        </digest>
        <description>
          <div class="document">
<p>For multichannel sources, which channel should be processed.</p>
</div>

          <h5>Constraints</h5><ul><li>Minimum: 0</li></ul>
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='0' /></attributelist></attribute><attribute name='startframe' get='1' set='1' type='int' size='1'>
        <digest>
          Source Offset
        </digest>
        <description>
          <div class="document">
<p>Where in the srcBuf should the slicing process start, in sample.</p>
</div>

          <h5>Constraints</h5><ul><li>Minimum: 0</li></ul>
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='0' /></attributelist></attribute><attribute name='threshold' get='1' set='1' type='float64' size='1'>
        <digest>
          Threshold
        </digest>
        <description>
          <div class="document">
<p>The thresholding of a new slice. Value ranges are different for each metric, from 0 upwards.</p>
</div>

          <h5>Constraints</h5><ul><li>Minimum: 0</li></ul>
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='0.5' /></attributelist></attribute><attribute name='warnings' get='1' set='1' type='int' size='1'>
        <digest>
          Warnings
        </digest>
        <description>
          <div class="document">
<p>Enable warnings to be issued whenever a parameter value is constrained (e.g. clipped)</p>
</div>

          <h5>Constraints</h5><ul><li>Minimum: 0</li><li>Maximum: 1</li></ul>
        </description><attributelist><attribute name="default" get="1" set="1" type="int" size='1' value='0' /></attributelist></attribute></attributelist>
	<!--RELATED-->
	<seealsolist>
    
    <seealso name='fluid.onsetslice~' />
    <seealso name='fluid.bufampslice~' />
    <seealso name='fluid.bufnoveltyslice~' />
    <seealso name='fluid.buftransientslice~' />
	</seealsolist>
</c74object>